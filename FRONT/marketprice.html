<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SmartFarm Credit - Market Prices & Trends</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #27ae60;
            --secondary: #f1c40f;
            --cream: #fef9f4;
            --dark: #2c3e50;
            --light: #ecf0f1;
            --danger: #e74c3c;
            --success: #2ecc71;
            --glass: rgba(255, 255, 255, 0.7);
            --glass-border: rgba(255, 255, 255, 0.2);
            --shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background-color: var(--cream);
            color: var(--dark);
            line-height: 1.6;
            overflow-x: hidden;
        }

        /* Navigation */
        nav {
            background-color: var(--primary);
            padding: 15px 0;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .nav-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        .logo {
            display: flex;
            align-items: center;
            font-size: 24px;
            font-weight: 700;
            color: white;
            text-decoration: none;
        }

        .logo-icon {
            width: 30px;
            height: 30px;
            margin-right: 10px;
        }

        .logo span {
            color: var(--secondary);
        }

        .nav-links {
            display: flex;
            list-style: none;
        }

        .nav-links li {
            margin-left: 30px;
        }

        .nav-links a {
            color: white;
            font-weight: 500;
            transition: color 0.3s ease;
            text-decoration: none;
            position: relative;
        }

        .nav-links a::after {
            content: '';
            position: absolute;
            bottom: -5px;
            left: 0;
            width: 0;
            height: 2px;
            background-color: var(--secondary);
            transition: width 0.3s ease;
        }

        .nav-links a:hover::after {
            width: 100%;
        }

        .mobile-menu-btn {
            display: none;
            background: none;
            border: none;
            color: white;
            font-size: 24px;
            cursor: pointer;
        }

        .language-toggle {
            display: flex;
            margin-left: 20px;
            border: 1px solid var(--secondary);
            border-radius: 5px;
            overflow: hidden;
        }

        .lang-btn {
            padding: 5px 10px;
            background: white;
            border: none;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }

        .lang-btn.active {
            background: var(--secondary);
        }

        /* Main Content */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px 20px;
        }

        .page-header {
            text-align: center;
            margin-bottom: 40px;
            position: relative;
        }

        .page-header h1 {
            font-size: 36px;
            color: var(--primary);
            margin-bottom: 15px;
        }

        .page-header p {
            font-size: 18px;
            color: var(--dark);
            max-width: 700px;
            margin: 0 auto;
        }

        .page-header::after {
            content: '';
            display: block;
            width: 80px;
            height: 4px;
            background-color: var(--secondary);
            margin: 20px auto;
        }

        /* Market Price Controls */
        .price-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .region-selector {
            display: flex;
            align-items: center;
            background: var(--glass);
            backdrop-filter: blur(10px);
            padding: 10px 15px;
            border-radius: 12px;
            box-shadow: var(--shadow);
            border: 1px solid var(--glass-border);
        }

        .region-selector label {
            margin-right: 10px;
            font-weight: 500;
        }

        .region-selector select {
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 14px;
            min-width: 200px;
            background: white;
        }

        .search-filter {
            display: flex;
            align-items: center;
            background: var(--glass);
            backdrop-filter: blur(10px);
            padding: 10px 15px;
            border-radius: 12px;
            box-shadow: var(--shadow);
            border: 1px solid var(--glass-border);
        }

        .search-filter input {
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 14px;
            margin-right: 10px;
            min-width: 200px;
        }

        .search-filter button {
            padding: 8px 15px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .search-filter button:hover {
            background: #219653;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }

        /* Price Cards */
        .price-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 25px;
            margin-top: 30px;
        }

        .price-card {
            background: var(--glass);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            overflow: hidden;
            box-shadow: var(--shadow);
            transition: all 0.3s ease;
            position: relative;
            border: 1px solid var(--glass-border);
        }

        .price-card:hover {
            transform: translateY(-10px) scale(1.02);
            box-shadow: 0 15px 30px rgba(0,0,0,0.15);
        }

        .price-card-header {
            background: linear-gradient(135deg, var(--primary), #2ecc71);
            color: white;
            padding: 15px;
            position: relative;
        }

        .price-card-header h3 {
            font-size: 20px;
            margin-bottom: 5px;
        }

        .price-card-header p {
            font-size: 14px;
            opacity: 0.9;
        }

        .price-trend {
            position: absolute;
            top: 15px;
            right: 15px;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }

        .trend-up {
            background: rgba(46, 204, 113, 0.2);
            color: var(--success);
        }

        .trend-down {
            background: rgba(231, 76, 60, 0.2);
            color: var(--danger);
        }

        .price-card-body {
            padding: 20px;
        }

        .price-value {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 10px;
            color: var(--dark);
        }

        .price-meta {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
            font-size: 14px;
            color: #777;
        }

        .price-change {
            display: inline-block;
            padding: 3px 10px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 600;
        }

        .change-up {
            background: rgba(46, 204, 113, 0.1);
            color: var(--success);
        }

        .change-down {
            background: rgba(231, 76, 60, 0.1);
            color: var(--danger);
        }

        .price-history {
            height: 100px;
            margin-bottom: 15px;
            position: relative;
        }

        .price-card-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-top: 15px;
            border-top: 1px solid #eee;
        }

        .btn-view {
            padding: 8px 15px;
            background: var(--secondary);
            color: var(--dark);
            border: none;
            border-radius: 5px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .btn-view:hover {
            background: #e6b800;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }

        /* Price Trends Section */
        .trends-section {
            margin-top: 50px;
        }

        .trends-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .trends-header h2 {
            font-size: 28px;
            color: var(--primary);
        }

        .trends-controls {
            display: flex;
            gap: 10px;
        }

        .trend-period-selector {
            display: flex;
            background: var(--glass);
            backdrop-filter: blur(10px);
            border-radius: 10px;
            padding: 5px;
            box-shadow: var(--shadow);
            border: 1px solid var(--glass-border);
        }

        .period-btn {
            padding: 8px 15px;
            border: none;
            background: transparent;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .period-btn.active {
            background: var(--primary);
            color: white;
        }

        .trends-container {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 25px;
        }

        @media (max-width: 768px) {
            .trends-container {
                grid-template-columns: 1fr;
            }
        }

        .trend-chart-container {
            background: var(--glass);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 25px;
            box-shadow: var(--shadow);
            border: 1px solid var(--glass-border);
        }

        .trend-analysis {
            background: var(--glass);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 25px;
            box-shadow: var(--shadow);
            border: 1px solid var(--glass-border);
        }

        .trend-analysis h3 {
            font-size: 20px;
            color: var(--primary);
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid #eee;
        }

        .analysis-item {
            margin-bottom: 20px;
        }

        .analysis-item h4 {
            font-size: 16px;
            color: var(--dark);
            margin-bottom: 5px;
        }

        .analysis-item p {
            font-size: 14px;
            color: #666;
        }

        .trend-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-top: 20px;
        }

        .stat-card {
            background: white;
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        }

        .stat-value {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .stat-up {
            color: var(--success);
        }

        .stat-down {
            color: var(--danger);
        }

        .stat-label {
            font-size: 12px;
            color: #777;
        }

        /* Loading Animation */
        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 40px;
        }

        .spinner {
            width: 50px;
            height: 50px;
            border: 5px solid rgba(39, 174, 96, 0.2);
            border-radius: 50%;
            border-top-color: var(--primary);
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 40px;
            color: #777;
        }

        .empty-state i {
            font-size: 48px;
            margin-bottom: 15px;
            color: #ddd;
        }

        /* Notification */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 20px;
            background: var(--success);
            color: white;
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            z-index: 1000;
            transform: translateX(150%);
            transition: transform 0.3s ease;
        }

        .notification.show {
            transform: translateX(0);
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .nav-links {
                display: none;
                position: absolute;
                top: 70px;
                left: 0;
                right: 0;
                background-color: var(--primary);
                flex-direction: column;
                padding: 20px;
                box-shadow: 0 5px 10px rgba(0, 0, 0, 0.1);
            }

            .nav-links.active {
                display: flex;
            }

            .nav-links li {
                margin: 10px 0;
            }

            .mobile-menu-btn {
                display: block;
            }

            .price-controls {
                flex-direction: column;
                align-items: stretch;
            }

            .region-selector, .search-filter {
                width: 100%;
            }
            
            .trends-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 15px;
            }
            
            .trends-controls {
                width: 100%;
                justify-content: space-between;
            }
        }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .price-card {
            animation: fadeIn 0.5s ease-out;
            animation-fill-mode: both;
        }

        .price-card:nth-child(1) { animation-delay: 0.1s; }
        .price-card:nth-child(2) { animation-delay: 0.2s; }
        .price-card:nth-child(3) { animation-delay: 0.3s; }
        .price-card:nth-child(4) { animation-delay: 0.4s; }
        .price-card:nth-child(5) { animation-delay: 0.5s; }
        .price-card:nth-child(6) { animation-delay: 0.6s; }

        /* Pulse animation for important elements */
        .pulse {
            animation: pulse 2s infinite;
        }

        /* Updated price indicator */
        .updated-indicator {
            display: inline-block;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background-color: var(--success);
            margin-left: 5px;
            animation: pulse 1.5s infinite;
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav>
        <div class="nav-container">
            <a href="index.html" class="logo">
                <svg class="logo-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M12 2L3 7L12 12L21 7L12 2Z" fill="#f1c40f"/>
                    <path d="M3 12L12 17L21 12" stroke="#f1c40f" stroke-width="2"/>
                    <path d="M3 17L12 22L21 17" stroke="#f1c40f" stroke-width="2"/>
                    <circle cx="12" cy="12" r="2" fill="#f1c40f"/>
                </svg>
                SmartFarm <span>Credit</span>
            </a>
            
            <div style="display: flex; align-items: center;">
                <ul class="nav-links">
                  <li><a href="homepage.html" data-i18n="nav.home">Home</a></li>
                  <li><a href="marketprice.html" data-i18n="nav.prices">Market Prices</a></li>
                  <li><a href="guide.html" data-i18n="nav.guides">Crop Guides</a></li>
                  <li><a href="loan.html" data-i18n="nav.loans">Loans</a></li>
                  <li><a href="connect.html" data-i18n="nav.connect">Connect</a></li>
                  <li><a href="contact.html" data-i18n="nav.contact">Contact</a></li>
                </ul>
                
                <div class="language-toggle">
                    <button class="lang-btn active" data-lang="en">EN</button>
                    <button class="lang-btn" data-lang="kin">KIN</button>
                </div>
            </div>
            
            <button class="mobile-menu-btn">☰</button>
        </div>
    </nav>

    <!-- Notification -->
    <div class="notification" id="notification">
        <span id="notification-text">Prices updated successfully!</span>
    </div>

    <!-- Main Content -->
    <div class="container">
        <div class="page-header">
            <h1 data-i18n="prices.title">Market Prices & Trends</h1>
            <p data-i18n="prices.subtitle">Real-time agricultural commodity prices across Rwanda's major markets. Updated hourly. <span class="updated-indicator"></span></p>
        </div>

        <!-- Market Price Controls -->
        <div class="price-controls">
            <div class="region-selector">
                <label data-i18n="prices.region">Region:</label>
                <select id="region">
                    <option value="all" data-i18n="prices.all_regions">All Regions</option>
                    <option value="kigali">Kigali</option>
                    <option value="musanze">Musanze</option>
                    <option value="rubavu">Rubavu</option>
                    <option value="huye">Huye</option>
                    <option value="nyagatare">Nyagatare</option>
                    <option value="rwamagana">Rwamagana</option>
                    <option value="kayonza">Kayonza</option>
                    <option value="ngoma">Ngoma</option>
                    <option value="nyanza">Nyanza</option>
                    <option value="gisagara">Gisagara</option>
                    <option value="nyamagabe">Nyamagabe</option>
                    <option value="rusizi">Rusizi</option>
                    <option value="karongi">Karongi</option>
                    <option value="rutsiro">Rutsiro</option>
                    <option value="nyabihu">Nyabihu</option>
                    <option value="burera">Burera</option>
                    <option value="gicumbi">Gicumbi</option>
                    <option value="ruhango">Ruhango</option>
                    <option value="muhanga">Muhanga</option>
                    <option value="kamonyi">Kamonyi</option>
                    <option value="bugesera">Bugesera</option>
                    <option value="gasabo">Gasabo</option>
                    <option value="kicukiro">Kicukiro</option>
                    <option value="nyarugenge">Nyarugenge</option>
                </select>
            </div>

            <div class="search-filter">
                <input type="text" placeholder="Search crops..." id="search-crop" data-i18n-placeholder="prices.search_placeholder">
                <button id="search-btn" data-i18n="prices.search"><i class="fas fa-search"></i> Search</button>
            </div>
        </div>

        <!-- Loading State -->
        <div class="loading" id="loading">
            <div class="spinner"></div>
        </div>

        <!-- Price Grid -->
        <div class="price-grid" id="price-grid">
            <!-- Prices will be loaded dynamically -->
        </div>

        <!-- Empty State -->
        <div class="empty-state" id="empty-state" style="display: none;">
            <i class="fas fa-search"></i>
            <h3 data-i18n="prices.no_results">No matching crops found</h3>
            <p data-i18n="prices.try_again">Try adjusting your search or filter criteria</p>
        </div>

        <!-- Price Trends Section -->
        <div class="trends-section">
            <div class="trends-header">
                <h2 data-i18n="prices.trends_title">Price Trends Analysis</h2>
                <div class="trends-controls">
                    <div class="trend-period-selector">
                        <button class="period-btn active" data-period="7">7 Days</button>
                        <button class="period-btn" data-period="30">30 Days</button>
                        <button class="period-btn" data-period="90">90 Days</button>
                        <button class="period-btn" data-period="365">1 Year</button>
                    </div>
                    <select id="trend-crop-selector">
                        <option value="coffee">Coffee</option>
                        <option value="maize">Maize</option>
                        <option value="beans">Beans</option>
                        <option value="tea">Tea</option>
                        <option value="potatoes">Potatoes</option>
                    </select>
                </div>
            </div>
            
            <div class="trends-container">
                <div class="trend-chart-container">
                    <canvas id="trend-chart" height="350"></canvas>
                </div>
                
                <div class="trend-analysis">
                    <h3>Trend Analysis</h3>
                    <div class="analysis-item">
                        <h4>Current Trend</h4>
                        <p id="current-trend">Prices are showing a steady upward trend over the past 7 days.</p>
                    </div>
                    <div class="analysis-item">
                        <h4>Market Outlook</h4>
                        <p id="market-outlook">Strong demand and limited supply are driving prices higher.</p>
                    </div>
                    <div class="analysis-item">
                        <h4>Recommendation</h4>
                        <p id="recommendation">Consider selling now to capitalize on current high prices.</p>
                    </div>
                    
                    <div class="trend-stats">
                        <div class="stat-card">
                            <div class="stat-value stat-up" id="avg-price">2,450</div>
                            <div class="stat-label">Avg Price (RWF)</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value stat-up" id="price-change">+5.2%</div>
                            <div class="stat-label">Price Change</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="volatility">12.5%</div>
                            <div class="stat-label">Volatility</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value stat-up" id="trend-strength">Strong</div>
                            <div class="stat-label">Trend Strength</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Language translations
        const translations = {
            en: {
                "nav.home": "Home",
                "nav.prices": "Market Prices",
                "nav.guides": "Crop Guides",
                "nav.loans": "Loans",
                "nav.connect": "Connect",
                "nav.login": "Login",
                "prices.title": "Market Prices & Trends",
                "prices.subtitle": "Real-time agricultural commodity prices across Rwanda's major markets. Updated hourly.",
                "prices.region": "Region:",
                "prices.all_regions": "All Regions",
                "prices.search_placeholder": "Search crops...",
                "prices.search": "Search",
                "prices.trends_title": "Price Trends Analysis",
                "prices.last_7": "Last 7 days",
                "prices.last_30": "Last 30 days",
                "prices.last_90": "Last 90 days",
                "prices.last_year": "Last year",
                "prices.updated": "Updated:",
                "prices.trend": "7-day trend:",
                "prices.view_details": "View Details",
                "prices.rwf": "RWF/kg",
                "prices.no_results": "No matching crops found",
                "prices.try_again": "Try adjusting your search or filter criteria",
                "prices.days_ago": "days ago"
            },
            kin: {
                "nav.home": "Ahabanza",
                "nav.prices": "Amafaranga y'isoko",
                "nav.guides": "Amabwiriza y'ubuhinzi",
                "nav.loans": "Inguzanyo",
                "nav.connect": "Kwihuza",
                "nav.login": "Injira",
                "prices.title": "Amafaranga y'isoko n'Imiterere",
                "prices.subtitle": "Amafaranga y'ibihingwa mu masoko makuru yo mu Rwanda. Yahindurwa buri saa.",
                "prices.region": "Akarere:",
                "prices.all_regions": "Amarere yose",
                "prices.search_placeholder": "Shakisha ibihingwa...",
                "prices.search": "Shakisha",
                "prices.trends_title": "Igipimo cy'imiterere y'amafaranga",
                "prices.last_7": "Iminsi 7 ishize",
                "prices.last_30": "Iminsi 30 ishize",
                "prices.last_90": "Iminsi 90 ishize",
                "prices.last_year": "Umwaka ushize",
                "prices.updated": "Yahinduwe:",
                "prices.trend": "Imiterere y'iminsi 7:",
                "prices.view_details": "Reba ibisobanuro",
                "prices.rwf": "RWF/kg",
                "prices.no_results": "Nta bihingwa bihuye n'ibisabwa byabonetse",
                "prices.try_again": "Gerageza guhindura amahitamo yawe yo gushakisha",
                "prices.days_ago": "iminsi ishize"
            }
        };

        // Rwandan crops and sample prices (2023 RURA data)
        const cropsData = {
            kigali: [
                { name: "Coffee", price: 2450, change: 60, trend: 5.2, unit: "kg" },
                { name: "Beans", price: 1200, change: -22, trend: -3.1, unit: "kg" },
                { name: "Maize", price: 700, change: 8, trend: 2.4, unit: "kg" },
                { name: "Irish Potatoes", price: 850, change: 25, trend: 7.5, unit: "kg" },
                { name: "Bananas", price: 500, change: -5, trend: -1.8, unit: "kg" },
                { name: "Tea", price: 1800, change: 27, trend: 4.3, unit: "kg" }
            ],
            musanze: [
                { name: "Irish Potatoes", price: 800, change: 15, trend: 6.2, unit: "kg" },
                { name: "Wheat", price: 900, change: 10, trend: 3.5, unit: "kg" },
                { name: "Beans", price: 1100, change: -15, trend: -2.8, unit: "kg" },
                { name: "Maize", price: 650, change: 5, trend: 1.2, unit: "kg" },
                { name: "Pyrethrum", price: 3200, change: 45, trend: 8.1, unit: "kg" }
            ],
            rubavu: [
                { name: "Tea", price: 1750, change: 20, trend: 3.8, unit: "kg" },
                { name: "Coffee", price: 2300, change: 35, trend: 4.7, unit: "kg" },
                { name: "Bananas", price: 450, change: -8, trend: -2.1, unit: "kg" },
                { name: "Beans", price: 1150, change: -10, trend: -1.5, unit: "kg" }
            ],
            huye: [
                { name: "Maize", price: 680, change: 12, trend: 3.1, unit: "kg" },
                { name: "Beans", price: 1250, change: -18, trend: -3.5, unit: "kg" },
                { name: "Sorghum", price: 750, change: 5, trend: 1.2, unit: "kg" },
                { name: "Sweet Potatoes", price: 600, change: 15, trend: 4.2, unit: "kg" }
            ],
            nyagatare: [
                { name: "Maize", price: 650, change: 8, trend: 2.1, unit: "kg" },
                { name: "Beans", price: 1100, change: -12, trend: -2.5, unit: "kg" },
                { name: "Cassava", price: 400, change: 5, trend: 1.8, unit: "kg" },
                { name: "Sorghum", price: 700, change: 10, trend: 2.8, unit: "kg" },
                { name: "Rice", price: 1500, change: 25, trend: 5.5, unit: "kg" }
            ],
            rwamagana: [
                { name: "Beans", price: 1200, change: -10, trend: -2.1, unit: "kg" },
                { name: "Maize", price: 700, change: 15, trend: 3.5, unit: "kg" },
                { name: "Sweet Potatoes", price: 550, change: 8, trend: 2.3, unit: "kg" }
            ],
            kayonza: [
                { name: "Rice", price: 1450, change: 30, trend: 6.2, unit: "kg" },
                { name: "Maize", price: 680, change: 10, trend: 2.5, unit: "kg" },
                { name: "Beans", price: 1150, change: -8, trend: -1.8, unit: "kg" }
            ]
        };

        // Price trend data for different crops and time periods
        const trendData = {
            coffee: {
                '7': [2350, 2400, 2420, 2380, 2450, 2430, 2450],
                '30': [2200, 2250, 2300, 2280, 2320, 2350, 2380, 2400, 2420, 2380, 2350, 2400, 2420, 2450, 2430, 2400, 2380, 2350, 2320, 2300, 2280, 2250, 2200, 2180, 2150, 2200, 2250, 2300, 2350, 2400],
                '90': Array.from({length: 90}, (_, i) => 2000 + Math.sin(i/10) * 300 + Math.random() * 100),
                '365': Array.from({length: 12}, (_, i) => {
                    const base = 2000;
                    const seasonal = Math.sin(i/2) * 400;
                    const trend = i * 20;
                    return Math.round(base + seasonal + trend + Math.random() * 100);
                })
            },
            maize: {
                '7': [680, 670, 690, 700, 710, 705, 700],
                '30': Array.from({length: 30}, (_, i) => 650 + Math.sin(i/5) * 30 + Math.random() * 20),
                '90': Array.from({length: 90}, (_, i) => 600 + Math.sin(i/15) * 50 + Math.random() * 30),
                '365': Array.from({length: 12}, (_, i) => {
                    const base = 550;
                    const seasonal = Math.sin(i/2) * 100;
                    const trend = i * 10;
                    return Math.round(base + seasonal + trend + Math.random() * 50);
                })
            },
            beans: {
                '7': [1150, 1170, 1200, 1180, 1190, 1210, 1200],
                '30': Array.from({length: 30}, (_, i) => 1100 + Math.sin(i/4) * 50 + Math.random() * 30),
                '90': Array.from({length: 90}, (_, i) => 1000 + Math.sin(i/12) * 100 + Math.random() * 50),
                '365': Array.from({length: 12}, (_, i) => {
                    const base = 900;
                    const seasonal = Math.sin(i/2) * 150;
                    const trend = i * 25;
                    return Math.round(base + seasonal + trend + Math.random() * 80);
                })
            },
            tea: {
                '7': [1750, 1780, 1800, 1820, 1810, 1790, 1800],
                '30': Array.from({length: 30}, (_, i) => 1700 + Math.sin(i/6) * 80 + Math.random() * 40),
                '90': Array.from({length: 90}, (_, i) => 1600 + Math.sin(i/10) * 150 + Math.random() * 60),
                '365': Array.from({length: 12}, (_, i) => {
                    const base = 1500;
                    const seasonal = Math.sin(i/2) * 200;
                    const trend = i * 30;
                    return Math.round(base + seasonal + trend + Math.random() * 100);
                })
            },
            potatoes: {
                '7': [800, 810, 820, 815, 830, 825, 850],
                '30': Array.from({length: 30}, (_, i) => 750 + Math.sin(i/3) * 60 + Math.random() * 30),
                '90': Array.from({length: 90}, (_, i) => 700 + Math.sin(i/8) * 100 + Math.random() * 50),
                '365': Array.from({length: 12}, (_, i) => {
                    const base = 650;
                    const seasonal = Math.sin(i/2) * 120;
                    const trend = i * 15;
                    return Math.round(base + seasonal + trend + Math.random() * 60);
                })
            }
        };

        // Trend analysis content
        const trendAnalysis = {
            coffee: {
                '7': {
                    current: "Coffee prices are showing a steady upward trend over the past 7 days.",
                    outlook: "Strong international demand and limited local supply are driving prices higher.",
                    recommendation: "Consider selling now to capitalize on current high prices."
                },
                '30': {
                    current: "Coffee prices have been volatile but generally trending upward over the past month.",
                    outlook: "Market uncertainty due to weather conditions is creating price fluctuations.",
                    recommendation: "Monitor market closely and consider selling in smaller batches."
                },
                '90': {
                    current: "Coffee prices show a clear seasonal pattern with recent strengthening.",
                    outlook: "Export demand is expected to remain strong through the next quarter.",
                    recommendation: "Hold inventory for now as prices are expected to continue rising."
                },
                '365': {
                    current: "Coffee prices have shown strong annual growth with seasonal variations.",
                    outlook: "Global supply constraints and increasing demand suggest continued price strength.",
                    recommendation: "Consider long-term contracts to lock in favorable prices."
                }
            },
            // Similar analysis for other crops...
        };

        // Initialize Charts
        let priceChart;
        const trendCtx = document.getElementById('trend-chart').getContext('2d');

        function initTrendChart(crop, period) {
            const data = trendData[crop][period];
            let labels;
            
            if (period === '7') {
                labels = ['6 days ago', '5 days ago', '4 days ago', '3 days ago', '2 days ago', 'Yesterday', 'Today'];
            } else if (period === '30') {
                labels = Array.from({length: 30}, (_, i) => `${29-i} days ago`);
            } else if (period === '90') {
                labels = Array.from({length: 90}, (_, i) => `${89-i} days ago`);
            } else if (period === '365') {
                labels = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
            }
            
            if (priceChart) {
                priceChart.destroy();
            }
            
            // Calculate trend statistics
            const currentPrice = data[data.length - 1];
            const previousPrice = data[0];
            const priceChange = ((currentPrice - previousPrice) / previousPrice * 100).toFixed(1);
            const avgPrice = (data.reduce((a, b) => a + b, 0) / data.length).toFixed(0);
            
            // Calculate volatility (standard deviation as percentage of average)
            const variance = data.reduce((acc, val) => acc + Math.pow(val - avgPrice, 2), 0) / data.length;
            const volatility = (Math.sqrt(variance) / avgPrice * 100).toFixed(1);
            
            // Update trend analysis
            document.getElementById('current-trend').textContent = trendAnalysis[crop][period].current;
            document.getElementById('market-outlook').textContent = trendAnalysis[crop][period].outlook;
            document.getElementById('recommendation').textContent = trendAnalysis[crop][period].recommendation;
            
            // Update stats
            document.getElementById('avg-price').textContent = avgPrice;
            document.getElementById('price-change').textContent = `${priceChange > 0 ? '+' : ''}${priceChange}%`;
            document.getElementById('price-change').className = `stat-value ${priceChange > 0 ? 'stat-up' : 'stat-down'}`;
            document.getElementById('volatility').textContent = `${volatility}%`;
            document.getElementById('trend-strength').textContent = Math.abs(priceChange) > 10 ? 'Strong' : 'Moderate';
            document.getElementById('trend-strength').className = `stat-value ${priceChange > 0 ? 'stat-up' : 'stat-down'}`;
            
            priceChart = new Chart(trendCtx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        label: `${crop.charAt(0).toUpperCase() + crop.slice(1)} Price (RWF/kg)`,
                        data: data,
                        backgroundColor: 'rgba(39, 174, 96, 0.2)',
                        borderColor: 'rgba(39, 174, 96, 1)',
                        borderWidth: 3,
                        tension: 0.4,
                        fill: true,
                        pointBackgroundColor: 'rgba(39, 174, 96, 1)',
                        pointBorderColor: '#fff',
                        pointBorderWidth: 2,
                        pointRadius: 4,
                        pointHoverRadius: 6
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        title: {
                            display: true,
                            text: `${crop.charAt(0).toUpperCase() + crop.slice(1)} Price Trend - ${period === '7' ? '7 Days' : period === '30' ? '30 Days' : period === '90' ? '90 Days' : '1 Year'}`,
                            font: {
                                size: 16,
                                weight: 'bold'
                            }
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return `${context.parsed.y} RWF/kg`;
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: false,
                            title: {
                                display: true,
                                text: 'Price (RWF/kg)'
                            },
                            grid: {
                                color: 'rgba(0, 0, 0, 0.05)'
                            }
                        },
                        x: {
                            grid: {
                                color: 'rgba(0, 0, 0, 0.05)'
                            }
                        }
                    },
                    interaction: {
                        intersect: false,
                        mode: 'index'
                    }
                }
            });
        }

        // Show notification
        function showNotification(message) {
            const notification = document.getElementById('notification');
            const notificationText = document.getElementById('notification-text');
            
            notificationText.textContent = message;
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }

        // Generate price cards
        function generatePriceCards(district) {
            const grid = document.getElementById('price-grid');
            const loading = document.getElementById('loading');
            const emptyState = document.getElementById('empty-state');
            
            // Show loading
            grid.innerHTML = '';
            loading.style.display = 'flex';
            emptyState.style.display = 'none';
            
            // Simulate API call delay
            setTimeout(() => {
                const crops = cropsData[district] || Object.values(cropsData).flat();
                
                if (crops.length === 0) {
                    emptyState.style.display = 'block';
                    loading.style.display = 'none';
                    return;
                }
                
                grid.innerHTML = '';
                
                crops.forEach((crop, index) => {
                    const isPositive = crop.change >= 0;
                    const changeClass = isPositive ? 'change-up' : 'change-down';
                    const trendClass = isPositive ? 'trend-up' : 'trend-down';
                    const trendSymbol = isPositive ? '↑' : '↓';
                    
                    const card = document.createElement('div');
                    card.className = 'price-card';
                    card.style.animationDelay = `${index * 0.1}s`;
                    card.onclick = () => {
                        // Set the trend chart to this crop
                        document.getElementById('trend-crop-selector').value = crop.name.toLowerCase();
                        initTrendChart(crop.name.toLowerCase(), '7');
                        showNotification(`${crop.name} trend analysis loaded`);
                    };
                    
                    card.innerHTML = `
                        <div class="price-card-header">
                            <h3>${crop.name}</h3>
                            <p>${district.charAt(0).toUpperCase() + district.slice(1)} Market</p>
                            <div class="price-trend ${trendClass}">
                                ${trendSymbol} ${Math.abs(crop.trend)}%
                            </div>
                        </div>
                        <div class="price-card-body">
                            <div class="price-value">${crop.price} <span data-i18n="prices.rwf">RWF/kg</span></div>
                            <div class="price-meta">
                                <span data-i18n="prices.updated">Updated:</span>
                                <span class="price-change ${changeClass}">${isPositive ? '+' : ''}${crop.change} RWF</span>
                            </div>
                            <div class="price-history">
                                <canvas height="100"></canvas>
                            </div>
                            <div class="price-card-footer">
                                <span data-i18n="prices.trend">7-day trend: <strong style="color:${isPositive ? '#2ecc71' : '#e74c3c'};">${trendSymbol} ${Math.abs(crop.trend)}%</strong></span>
                                <button class="btn-view" data-i18n="prices.view_details"><i class="fas fa-chart-line"></i> View Details</button>
                            </div>
                        </div>
                    `;
                    
                    grid.appendChild(card);
                    
                    // Add mini chart to card
                    const miniCtx = card.querySelector('canvas').getContext('2d');
                    new Chart(miniCtx, {
                        type: 'line',
                        data: {
                            labels: Array.from({length: 7}, (_, i) => i+1),
                            datasets: [{
                                data: Array.from({length: 7}, () => Math.floor(crop.price * (0.9 + Math.random() * 0.2))),
                                borderColor: isPositive ? '#2ecc71' : '#e74c3c',
                                borderWidth: 2,
                                tension: 0.4,
                                fill: false,
                                pointRadius: 0
                            }]
                        },
                        options: {
                            responsive: true,
                            plugins: {
                                legend: { display: false },
                                tooltip: { enabled: false }
                            },
                            scales: {
                                x: { display: false },
                                y: { display: false }
                            }
                        }
                    });
                });
                
                loading.style.display = 'none';
                showNotification(`Prices for ${district === 'all' ? 'all regions' : district} loaded`);
            }, 800);
        }

        // Language switching
        let currentLang = 'en';
        
        function switchLanguage(lang) {
            currentLang = lang;
            document.querySelectorAll('[data-i18n]').forEach(el => {
                const key = el.getAttribute('data-i18n');
                if (translations[lang][key]) {
                    el.textContent = translations[lang][key];
                }
            });
            
            document.querySelectorAll('[data-i18n-placeholder]').forEach(el => {
                const key = el.getAttribute('data-i18n-placeholder');
                if (translations[lang][key]) {
                    el.placeholder = translations[lang][key];
                }
            });
            
            // Update chart if it exists
            if (priceChart) {
                priceChart.update();
            }
            
            // Update price cards
            generatePriceCards(document.getElementById('region').value);
        }

        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            // Set up language toggle
            document.querySelectorAll('.lang-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('.lang-btn').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    switchLanguage(this.dataset.lang);
                });
            });
            
            // Set up region selector
            document.getElementById('region').addEventListener('change', function() {
                generatePriceCards(this.value);
            });
            
            // Set up search
            document.getElementById('search-btn').addEventListener('click', function() {
                const searchTerm = document.getElementById('search-crop').value.toLowerCase();
                const region = document.getElementById('region').value;
                
                if (!searchTerm) {
                    generatePriceCards(region);
                    return;
                }
                
                const grid = document.getElementById('price-grid');
                const emptyState = document.getElementById('empty-state');
                
                // Filter crops
                const allCrops = cropsData[region] || Object.values(cropsData).flat();
                const filteredCrops = allCrops.filter(crop => 
                    crop.name.toLowerCase().includes(searchTerm)
                );
                
                if (filteredCrops.length === 0) {
                    grid.innerHTML = '';
                    emptyState.style.display = 'block';
                    return;
                }
                
                // Re-render with filtered crops
                grid.innerHTML = '';
                filteredCrops.forEach((crop, index) => {
                    const isPositive = crop.change >= 0;
                    const changeClass = isPositive ? 'change-up' : 'change-down';
                    const trendClass = isPositive ? 'trend-up' : 'trend-down';
                    const trendSymbol = isPositive ? '↑' : '↓';
                    
                    const card = document.createElement('div');
                    card.className = 'price-card';
                    card.style.animationDelay = `${index * 0.1}s`;
                    
                    card.innerHTML = `
                        <div class="price-card-header">
                            <h3>${crop.name}</h3>
                            <p>${region.charAt(0).toUpperCase() + region.slice(1)} Market</p>
                            <div class="price-trend ${trendClass}">
                                ${trendSymbol} ${Math.abs(crop.trend)}%
                            </div>
                        </div>
                        <div class="price-card-body">
                            <div class="price-value">${crop.price} <span data-i18n="prices.rwf">RWF/kg</span></div>
                            <div class="price-meta">
                                <span data-i18n="prices.updated">Updated:</span>
                                <span class="price-change ${changeClass}">${isPositive ? '+' : ''}${crop.change} RWF</span>
                            </div>
                            <div class="price-history">
                                <canvas height="100"></canvas>
                            </div>
                            <div class="price-card-footer">
                                <span data-i18n="prices.trend">7-day trend: <strong style="color:${isPositive ? '#2ecc71' : '#e74c3c'};">${trendSymbol} ${Math.abs(crop.trend)}%</strong></span>
                                <button class="btn-view" data-i18n="prices.view_details"><i class="fas fa-chart-line"></i> View Details</button>
                            </div>
                        </div>
                    `;
                    
                    grid.appendChild(card);
                });
                
                emptyState.style.display = 'none';
            });
            
            // Set up trend period selector
            document.querySelectorAll('.period-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('.period-btn').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    const period = this.dataset.period;
                    const crop = document.getElementById('trend-crop-selector').value;
                    initTrendChart(crop, period);
                });
            });
            
            // Set up crop selector for trends
            document.getElementById('trend-crop-selector').addEventListener('change', function() {
                const crop = this.value;
                const period = document.querySelector('.period-btn.active').dataset.period;
                initTrendChart(crop, period);
            });
            
            // Mobile menu toggle
            document.querySelector('.mobile-menu-btn').addEventListener('click', function() {
                document.querySelector('.nav-links').classList.toggle('active');
            });
            
            // Initialize with default data
            generatePriceCards('all');
            initTrendChart('coffee', '7');
        });
    </script>
</body>
</html>